Elastic Ball Test
//----------------------------------------------------
ControlParameters {
  Units CGS
  TerminationTime 100.0 ms
  TerminationTime 0.1 ms
  MaximumTimeStep 0.0001 ms
  TimeStepScalingFactor 0.8
  Monitor Frequency 10 // print progress line every 10 steps
//  Flush every 0.001 ms
// GoI every 0.002 ms
  GoInt atTime 0.0999 ms
  PlottingDefaults {
    X-DisplacementScalingFactor 1000
    Y-DisplacementScalingFactor 1000
    Z-DisplacementScalingFactor 1000
  }
//  WritePlotDataFile plot.dat Every 0.002 ms
}
// Gravity 10.0 m/s2 Direction 0. 0. -1.
//
//----------------------------------------------------
//
Material CONC Elastic {
   Density 2500.00 kg/m3
   YoungModulus 3.0 MPa
   PoissonsRatio 0.3
}
//
//----------------------------------------------------
//
HexSolidList BALL 8IP {
  Material CONC
  Color rust
  ReadFile solidmesh.mrs
  NodeList {
      Select do 1 3
      Make ndL FIXN
      Set TranslationsBC XXX
      InvertSelection
      Set TranslationsBC XXO
      Make ndL MOVN
      Select all
//    Set X-Velocity 0.0 m/s
//    Set Y-Velocity 0.0 m/s
//    Set Z-Velocity 0.0 m/s
  }
}
//
NodeList FIXN {
  Plotting enabled
  Color blue
  PlotAttributes {
    MinRadius .5 mm
  }
}
//
NodeList MOVN {
  Plotting enabled
  Color red
  PlotAttributes {
    MinRadius 1. mm
  }
}
//
//----------------------------------------------------------------------
// APPLIED LOAD
//----------------------------------------------------------------------
LoadCurve VELO {
  X-units time ms
  Y-units velocity mm/s
  npt 2
  tab
  0	  10
  100     10
}
//----------------------------------------------------------------------
//
PrescribedVelocityList VELO {
  LoadCurve VELO
  Direction 0 0 1
  Scale 1
  NodeList MOVN 
  All
}
//

//----------------------------------------------------
//   O U T P U T
//----------------------------------------------------
//
TimeHistoryList Hist {
  dt 0.0001 ms
//  ndL-MOVN fx
//  ndL-MOVN fy
//  ndL-MOVN fz
//  ndL-MOVN cx
//  ndL-MOVN cy
//  ndL-MOVN cz
  nd-BALL 216 fx
  nd-BALL 216 fy
  nd-BALL 216 fz
  nd-BALL 216 cx
  nd-BALL 216 cy
  nd-BALL 216 cz D

//  nd-BALL cl 0 cm 0 cm 0 cm vx
//  nd-BALL cl 0 cm 0 cm 0 cm cx D
//  nd-BALL cl 0 cm 0 cm 0 cm vy
//  nd-BALL cl 0 cm 0 cm 0 cm cy D
//  nd-BALL cl 0 cm 0 cm 0 cm vz
//  nd-BALL cl 0 cm 0 cm 0 cm cz D
//  hxL-BALL Volume
  // Energy quantities
  ke // kinetic energy
  ie // elastic energy
  eb // energy ballance
  ew // esternal work
  iw S -1 // internal work
}
//
//----------------------------------------------------------------------
//
PlotList PLOT {
  dt 3 ms
  All
  DeleteAllFiles
}
fdL Ball {
}
EOF
