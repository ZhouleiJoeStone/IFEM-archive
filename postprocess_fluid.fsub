ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
c    calculates dependend variables
c    writes fluid field variables to output, if necessary
ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
c.....   if calcforce=1, calculate the dragforce,
c.....	 if calcforce=0, no calculation
c        if (calcforce) then
c          call error("lift and drag force",-999,.false.)
c          call getfdrag(fdrag,d,x,ien,rng,hn,hm)
c          call fdragout(tt,fdrag,1,3)
c        end if

c... Output every ntsbout step
        if(mod(its,ntsbout).eq.0) then
c          if(surf(0).gt.0) call dyno(x,d,rng,ien)
          idisk = idisk+1
          assemble=.false.
          call scatter(d,dn,ndf,assemble,hn,hm)
          call diskout(dn,dd)
        end if