! OUTPUT generator for both fluids and structure parts
! written by Lucy Zhang
! 12/5/02
! write output in different files each timestep (or less often)
!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
! origin:  ibm code
! n_matlab = 1  :  matlab output
!
! n_tec_ens =1  :  tecplot output
! n_tec_ens =0  :  ensight output
!

       if (its == 0) then

          write(*,*) "generating the output"

          if( n_tec_ens == 0) then   !ensight output

             call zfem_ensGeo(klok,ien,x,solid_fem_con,solid_coor_curr,x_inter,x_center,x_den,ien_den,x_inter_ini,nn_inter_ini)
             call zfem_ensFluid(d,f_fluids,solid_force_FSI,solid_vel,solid_pave,solid_stress,solid_strain,klok,f_stress,nn_inter_ini,vel_inter)
             call zfem_ensCase(dt,its,ntsbout)
	     call zfem_ensInter(I_fluid,I_fluid_center,I_fluid_den,norm_fluid,norm_inter,Ic_inter,klok,nn_inter_ini)

          endif

       elseif (mod(its,ntsbout) == 0) then

          write(*,*) "generating the output"

          if( n_tec_ens == 0) then   !ensight output

             call zfem_ensGeo(klok,ien,x,solid_fem_con,solid_coor_curr,x_inter,x_center,x_den,ien_den,x_inter_ini,nn_inter_ini)
             call zfem_ensFluid(d,f_fluids,solid_force_FSI,solid_vel,solid_pave,solid_stress,solid_strain,klok,f_stress,nn_inter_ini,vel_inter)
             call zfem_ensCase(dt,its,ntsbout)
	     call zfem_ensInter(I_fluid,I_fluid_center,I_fluid_den,norm_fluid,norm_inter,Ic_inter,klok,nn_inter_ini)

          endif

       endif


