ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
c    calculates dependend variables
c    writes fluid field variables to output, if necessary
ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
        if (calcforce) then
          call error("lift and drag force",-999,.false.)
          call getfdrag(fdrag,d,x,ien,rng,hn,hm)
          call fdragout(tt,fdrag,1,3)
        end if
        if(mod(its,ntsbout).eq.0) then
          if(surf(0).gt.0) call dyno(x,d,rng,ien)
          idisk = idisk+1
          assemble=.false.
          call scatter(d,dn,ndf,assemble,hn,hm)
          call diskout(dn,dd)
        end if