ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
c   FEM Navier Stokes fluid solver
c     incompressible, implicit
ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
         call equal(d,do,ndf*nn)   !.....???
        do iit=1,nit
          call fclear(p,ndf*nn)
          call fclear(w,ndf*nn)

	! calculate residual of each degree of freedom, p and diagonal matrix w
          call block(x,d,do,p,w,hg,ien)

	! apply boundary conditions, calculate residual with corrected BC
	! i.e. if id=0, p=0
          call setid(p,id,ndf)

	! calculate the normalized the error, res_l
          call getnorm(p,p,ndf*nn,res_l)
          res_l= sqrt(res_l/nq)

	! calculate the increment(delta_d) for each degree of freedom, dg
          call fclear(dg,ndf*nn)
          call gmres(x,d,do,id,w,p,dg,hg,ien,
     &         z,v,zg,avg,sm,vloc,avloc,h_gmres,y_gmres,cc,ss)

	! calculate the normalized increment, del_l
          call getnorm(dg,dg,ndf*nn,del_l)
          del_l = sqrt(del_l/nq)

	! update the calculated variables, d=d+dg
          call update(p, d, dg, ndf)

	! output the errors in each iteration
          write(6,102) iit,res_l,del_l
          write(7,102) iit,res_l,del_l
        enddo